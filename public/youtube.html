<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HERA VIP</title>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 5px; margin: 0; text-align: center; }
        input { width: 95%; padding: 5px; background: #222; color: #fff; border: 1px solid #0f0; margin-bottom: 5px; }
        button { background: #050; color: #fff; border: 1px solid #0f0; font-weight: bold; cursor: pointer; padding: 5px; width: 100%; margin-bottom: 5px; }
        
        .video-item { border-bottom: 1px solid #333; padding: 10px 0; text-align: left; }
        .thumb-box { position: relative; width: 100%; height: auto; margin-bottom: 5px; text-align: center; }
        img { width: 120px; height: 90px; object-fit: cover; border: 1px solid #333; }
        
        /* KHUNG XEM VIDEO */
        .preview-frame { width: 100%; height: 200px; display: none; border: 1px solid white; }
        
        .info { overflow: hidden; }
        .title { font-size: 14px; color: white; font-weight: bold; display: block; margin-bottom: 5px; }
        .btn-dl { display: inline-block; width: 48%; background: #333; color: #fff; text-decoration: none; font-size: 11px; padding: 5px 0; margin-top: 2px; text-align: center; border: 1px solid #444; }
        .btn-watch { width: 100%; background: #b00; color: white; font-weight: bold; font-size: 13px; margin-bottom: 5px; cursor: pointer; border: 1px solid red; padding: 5px 0; display: block; text-align: center; }
    </style>
</head>
<body>

    <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm video..." onkeypress="if(event.key==='Enter') doSearch()">
    <button onclick="doSearch()">üîç T√åM KI·∫æM</button>

    <div id="results">
        <p style="color:#555">Nh·∫≠p t√™n video ƒë·ªÉ t√¨m & xem...</p>
    </div>

    <script>
        function renderVideos(list) {
            let html = '';
            list.forEach(v => {
                html += `
                <div class="video-item">
                    <div class="info">
                        <span class="title">${v.title}</span>
                        
                        <div class="thumb-box" id="box-${v.id}">
                            <img src="${v.thumbnail}" onclick="playPreview('${v.id}')">
                            <button class="btn-watch" onclick="playPreview('${v.id}')">‚ñ∂ XEM TH·ª¨</button>
                        </div>

                        <div style="display:flex; flex-wrap:wrap; gap:2px;">
                            <a href="/download?id=${v.id}&mode=direct" class="btn-dl" style="background:#0b0;">üöÄ T·∫¢I NHANH</a>
                            <a href="/download?id=${v.id}&mode=hera" class="btn-dl" style="background:#0ff; color:black;">T·∫¢I MP4</a>
                            <a href="/download?id=${v.id}&mode=sumo" class="btn-dl" style="background:#fa0; color:black;">T·∫¢I 3GP</a>
                        </div>
                    </div>
                </div>`;
            });
            document.getElementById('results').innerHTML = html;
        }

        // H√ÄM B·∫¨T VIDEO XEM TH·ª¨
        function playPreview(vidId) {
            const box = document.getElementById('box-' + vidId);
            // Thay ·∫£nh b·∫±ng Youtube Player
            box.innerHTML = `<iframe class="preview-frame" style="display:block" src="https://www.youtube.com/embed/${vidId}?autoplay=1" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
        }

        async function doSearch() {
            const q = document.getElementById('searchInput').value;
            if(!q) return;
            document.getElementById('results').innerHTML = '<p style="color:yellow">ƒêang t√¨m...</p>';
            try {
                const res = await fetch('/api/search?q=' + encodeURIComponent(q));
                const data = await res.json();
                renderVideos(data);
            } catch (e) { document.getElementById('results').innerHTML = 'L·ªói: ' + e; }
        }
    </script>
</body>
</html>