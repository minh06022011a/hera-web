<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HERA TUBEMATE</title>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 5px; text-align: center; }
        
        /* THANH TÌM KIẾM */
        .search-box { display: flex; gap: 5px; margin-bottom: 10px; }
        input { flex: 1; padding: 8px; background: #222; color: #fff; border: 1px solid #0f0; }
        button { background: #004400; color: #fff; border: 1px solid #0f0; font-weight: bold; cursor: pointer; }
        
        /* DANH SÁCH VIDEO */
        #results { text-align: left; }
        .video-item { 
            border: 1px solid #333; 
            margin-bottom: 5px; 
            padding: 5px; 
            display: flex; 
            align-items: center; 
            gap: 10px;
            background: #111;
        }
        .video-item:focus, .video-item:hover { background: #333; border-color: #0f0; } /* Hiệu ứng khi dùng phím điều hướng */
        
        img { width: 80px; height: 60px; object-fit: cover; }
        .info { flex: 1; }
        .title { font-size: 14px; color: white; display: block; height: 36px; overflow: hidden; }
        .duration { font-size: 12px; color: yellow; }
        
        /* NÚT TẢI */
        .actions { display: flex; flex-direction: column; gap: 5px; }
        .btn-dl { font-size: 11px; padding: 5px; text-decoration: none; color: white; background: #b00; display: block; text-align: center; }
        .btn-3gp { background: #b00; }
        .btn-mp4 { background: #00b; }
    </style>
</head>
<body>

    <div class="search-box">
        <input type="text" id="searchInput" placeholder="Tìm video (Sơn Tùng, thời sự...)" onkeypress="handleEnter(event)">
        <button onclick="doSearch()">TÌM</button>
    </div>

    <div id="results">
        <p style="text-align:center">Nhập từ khóa để tìm...</p>
    </div>

    <script>
        function handleEnter(e) { if(e.key === 'Enter') doSearch(); }

        async function doSearch() {
            const query = document.getElementById('searchInput').value;
            document.getElementById('results').innerHTML = '<p>Đang tìm...</p>';
            
            try {
                const res = await fetch('/api/search?q=' + encodeURIComponent(query));
                const videos = await res.json();
                
                let html = '';
                videos.forEach(v => {
                    html += `
                    <div class="video-item" tabindex="0">
                        <img src="${v.thumbnail}">
                        <div class="info">
                            <span class="title">${v.title}</span>
                            <span class="duration">${v.duration}</span>
                        </div>
                        <div class="actions">
                            <a href="/download?id=${v.id}&type=3gp" class="btn-dl btn-3gp">TẢI 3GP (Sumo)</a>
                            <a href="/download?id=${v.id}&type=mp4" class="btn-dl btn-mp4">TẢI MP4 (Hera)</a>
                        </div>
                    </div>`;
                });
                document.getElementById('results').innerHTML = html;
            } catch (err) {
                document.getElementById('results').innerHTML = '<p>Lỗi: ' + err + '</p>';
            }
        }
    </script>
</body>
</html>